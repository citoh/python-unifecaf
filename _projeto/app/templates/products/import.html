{% extends "base.html" %}
{% block content %}
<h2>Importar produtos via Excel</h2>

<p class="muted">
  Envie um arquivo .xlsx com as colunas: <b>Nome</b> | <b>Sku</b> | <b>Preço</b>
</p>

<form action="/products/import" method="post" enctype="multipart/form-data" class="form">
  <label>Arquivo (.xlsx)
    <input type="file" name="file" accept=".xlsx" required />
  </label>

  <div class="form-actions">
    <button type="button" class="btn" onclick="window.location.href='/products'"><i class="fas fa-times"></i> Cancelar</button>
    <button type="submit" class="btn primary"><i class="fas fa-file-import"></i> Importar</button>
  </div>
</form>

{% if report %}
  <hr>
  <h3>Resultado da importação</h3>
  <p>Importados: {{ report.imported }}</p>
  <p>Ignorados: {{ report.skipped }}</p>

  {% if report.errors and report.errors|length %}
    <h4>Erros</h4>
    <ul>
      {% for e in report.errors %}
        <li>Linha {{ e.row }}: {{ e.error }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endif %}
{% endblock %}